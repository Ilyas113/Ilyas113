<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Book Quote App</title>
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <nav>
        <ul>
            <li><a href="#" onclick="checkAuthAndShow('books')">á—·Ã¶á‘•KEá–‡</a></li>
            <li><a href="#" onclick="checkAuthAndShow('quotes')">ğ™¢ğ™ğ™£ğ™– ğ™™ğ™ğ™ ğ™©ğ™šğ™§</a></li>
            <li><a href="#" onclick="showSection('login')">ğ™¡ğ™¤ğ™œğ™œğ™– ğ™ğ™£</a></li>
        </ul>
    </nav>
    <main>
        <article id="books" class="hidden">
            <h1>à¹–à»à»k liÅt</h1>
            <button id="addBookBtn">LÃ¤gg till bÃ¶cker</button>
            <div id="bookForm" class="hidden">
                <input type="text" id="title" placeholder="Title">
                <input type="text" id="author" placeholder="Author">
                <input type="date" id="pubDate">
                <button id="saveBookBtn">Spara</button>
                <button id="cancelBtn">Avbryt</button>
            </div>
            <ul id="bookList"></ul>
        </article>
        <article id="quotes" class="hidden">
            <h1>Ğ¼Ñƒ qÏ…ÏƒÑ‚Ñ”Ñ•</h1>
            <ul id="quoteList">
                <li>
                    <details>
                        <summary>Aristotle</summary>
                        <p>Educating the mind without educating the heart is no education at all</p>
                    </details>
                </li>
                <li>
                    <details>
                        <summary>Friedrich Nietzsche</summary>
                        <p>He who has a why to live can bear almost any how</p>
                    </details>
                </li>
                <li>
                    <details>
                        <summary>Immanuel Kant</summary>
                        <p>Live your life as though your every act were to become a universal law</p>
                    </details>
                </li>
                <li>
                    <details>
                        <summary>SÃ¸ren Kierkegaard:</summary>
                        <p>Life can only be understood backwards; but it must be lived forwards</p>
                    </details>
                </li>
                <li>
                    <details>
                        <summary>Lao Tzu</summary>
                        <p>Being deeply loved by someone gives you strength, while loving someone deeply gives you courage</p>
                    </details>
                </li>
  
            </ul>
        </article>
        <article id="login" class="hidden">
            <div class="logo">
                <h1>á’ªOGIá‘</h1>
                <i class="fa-solid fa-lock" id="lock"></i>
            </div>
            <input type="text" id="username" placeholder="Username">
            <input type="password" id="password" placeholder="Password">
            <button id="loginBtn">ğ•ğ• ğ•˜ğ•šğ•Ÿ</button><br>
            <button onclick="logout()" class="out">á’ªOGOá‘ŒT</button>
            <p style="color: silver;"><em style="color: white;">Note: </em>ğ˜ ğ˜°ğ˜¶'ğ˜³ğ˜¦ ğ˜ªğ˜¯ğ˜´ğ˜ªğ˜¥ğ˜¦ ğ˜µğ˜©ğ˜¦ ğ˜±ğ˜³ğ˜°ğ˜¨ğ˜³ğ˜¢ğ˜® ğ˜¶ğ˜¯ğ˜µğ˜ªğ˜­ğ˜­ ğ˜ºğ˜°ğ˜¶ ğ˜­ğ˜°ğ˜¨ ğ˜–ğ˜¶ğ˜µ!</p>
        </article>
        <p id="out"></p>
    </main>
    <div class="footer">
        &copy; 2024 karimi74.se
    </div>
    <script src="scripts/app.js"></script>
    <script src="scripts/books.js"></script>
    <script src="scripts/quotes.js"></script>
    <script src="scripts/auth.js"></script>


    <script>
        document.addEventListener('DOMContentLoaded', () => { // VÃ¤ntar tills att sidan klar laddas
            if (localStorage.getItem('token') && localStorage.getItem('username')) { // kontrollerar om token och username existerar
                showSection('books'); // visa bok delen
                renderBooks(); // renderBooks fÃ¶r vidare funktion
                alert('VÃ¤lkommen tillbaks, ' + localStorage.getItem('username') + '!'); // VIsa pÃ¥ skÃ¤rmen 
            } else { // annars
                showSection('login'); // visa login delen
            }
            document.getElementById('addBookBtn').addEventListener('click', toggleBookForm); // lÃ¤ggar till addEventL fÃ¶r toggleBookForm
            document.getElementById('saveBookBtn').addEventListener('click', saveBook); // en event till sparaBÃ¶cker
            document.getElementById('cancelBtn').addEventListener('click', toggleBookForm); // event fÃ¶r att undiva bookForm
            document.getElementById('loginBtn').addEventListener('click', loginUser); // event fÃ¶r att login knappen
        });

        function showSection(article) { // funktion fÃ¶r att visa den specifika delen och gÃ¶mma resten.....
            document.querySelectorAll('main article').forEach(art => { // loopa genom alla article
                art.classList.add('hidden'); // lÃ¤gger till en class fÃ¶r att undiva article
            });
            document.getElementById(article).classList.remove('hidden'); // tabort nya classen fÃ¶r att visa den specifika article
        }

        function checkAuthAndShow(article) { // Funktion fÃ¶r att testa autentisering 
            if (localStorage.getItem('token')) { // kontrollerar om token finns i Storage
                showSection(article); // Visa den specifika article
                if (article === 'books') { // om den delen Ã¤r books
                    renderBooks(); // render den listan av boken
                }
            } else { // om inte autentiserad
                alert("Please log in to access this section."); // skicka meddelande
                showSection('login'); // Visa login delen
            }
        }

        function loginUser() { // HÃ¤r har jag en funktion for latt logga in anvÃ¤ndare
            var username = document.getElementById('username').value; // fÃ¥ upp anvÃ¤ndarnamn ifrÃ¥n input
            var password = document.getElementById('password').value; // fÃ¥ upp lÃ¶senord ifrÃ¥n input
            var success = document.getElementById('out'); // hÃ¤r fÃ¥r jag upp element fÃ¶r mina meddelande 

            if (!username || !password) { // om anvÃ¤ndarnmanet och lÃ¶s Ã¤r tÃ¶m
                alert('Please enter both username and password.'); // Meddela anvÃ¤ndare fÃ¶r att skriva bÃ¥da
                return; // ut ur funktion
            } else if (!/\d/.test(username)) { // kontrollerar om anvÃ¤ndarnamnet innehÃ¥ller minst ett nummer
                alert('Username must contain at least one number.'); // Meedelande till anvÃ¤ndare
                document.getElementById('username').value = ""; // rensa bort anvÃ¤ndar vÃ¤rde
                return; // ut ur funktion
            } else if (!/^[A-Z]/.test(password)) { // kontrollerar om lÃ¶s startas med en stor bokstav
                alert('Password must start with a capital letter.'); // Meddela
                document.getElementById('password').value = ""; // rensar bort lÃ¶s
                return; // ut ur funktion
            } else { // om validation godkÃ¤nnas
                alert("You're now Logged in!"); // meddela om lyckad!!

                var lock = document.getElementById('lock'); // fÃ¥ upp lÃ¥s ikonen
                lock.classList.remove('fa-lock'); // bort denn class fÃ¶r ikonen
                lock.classList.add('fa-unlock-keyhole'); // lÃ¤gger till ikonen fÃ¶r att byta ikonen
                lock.style.color = 'springgreen'; // bytar fÃ¤rget pÃ¥ ikonen
            }

            localStorage.setItem('token', 'logged_in'); // hÃ¤r sparar jag token in i localStorage
            localStorage.setItem('username', username); // hÃ¤r sparar jag anvÃ¤ndarnamn in i localStorage
            showSection('books'); // Visa bokens sektion
            renderBooks(); // render listen av boken
        }

        function logout() { // funktion fÃ¶r att logga ut 
            localStorage.removeItem('token'); // rensar bort token frÃ¥n Storage
            localStorage.removeItem('username'); // rensar bort anvÃ¤ndarnamn frÃ¥n Storage
            showSection('login'); // Visa den logga in sektion

            var loggedOut = document.getElementById('out'); // fÃ¥ upp output element fÃ¶r meddelande
            loggedOut.textContent = "You're now logged out!"; // sÃ¤tta meddelande fÃ¶r logga ut
            loggedOut.style.color = "yellow"; // byt meddelande fÃ¤rg
            loggedOut.style.textAlign = "center"; // text align to center

            setTimeout(function() { // sÃ¤tter redirect fÃ¶r att ha delay i funktion
                window.location.href = "index.html"; // Redirect to the index page
            }, 1500); // en delay av 1500 miliSec
        }

        var books = JSON.parse(localStorage.getItem('books')) || []; // Initiera bÃ¶cker array frÃ¥n localStorage eller som en tom array
        let editingBookIndex = null; // Initiera redigerande bokindex

        function renderBooks() { // Funktion fÃ¶r att rendera listan av bÃ¶cker
            var bookList = document.getElementById('bookList'); // HÃ¤mta boklistans element
            bookList.innerHTML = ''; // rensa bok listen
            books.forEach((book, index) => { // loopa genom varje bok
                var li = document.createElement('li'); // Skapa ett nytt listelement
                li.innerHTML = `
                    <span class="thisList">${book.title} by ${book.author} (publicerad: ${book.pubDate})</span>
                    <button onclick="redigeraBÃ¶cker(${index})">Redigera</button>
                    <button onclick="taBortBÃ¶cker(${index})">Ta bort</button>
                `; // SÃ¤tt den inre HTML med bokdetaljer och Ã¥tgÃ¤rdsknappar
                bookList.appendChild(li); // Foga listelementet till boklistan
            });
        }

        function toggleBookForm() { // funktion fÃ¶r att vÃ¤xla synligheten av bokformulÃ¤ret
            document.getElementById('bookForm').classList.toggle('hidden'); // VÃ¤xla 'hidden'-klassen pÃ¥ bokformulÃ¤ret
        }

        function saveBook() { // funktion fÃ¶r att spara bÃ¶cker
            var title = document.getElementById('title').value; // HÃ¤mta titeln frÃ¥n inmatningsfÃ¤ltet
            var author = document.getElementById('author').value; // HÃ¤mta fÃ¶rfattare frÃ¥n inmatningsfÃ¤ltet
            var pubDate = document.getElementById('pubDate').value; // HÃ¤mta publicerade datum frÃ¥n inmatningsfÃ¤ltet

            if (editingBookIndex !== null) { // Kontrollera om du redigerar en befintlig bok
                books[editingBookIndex] = { title, author, pubDate }; // updatera bokens detaljer
                editingBookIndex = null; // Ã…terstÃ¤ll indexet fÃ¶r redigering av bok
            } else { // om lÃ¤ggs en ny bok
                books.push({ title, author, pubDate }); // lÃ¤gga till boken i array listen
            }

            localStorage.setItem('books', JSON.stringify(books)); //spara uppdaterade bokens array till localStorage
            toggleBookForm(); // undvik bok form
            renderBooks(); // Rendera den uppdaterade boklistan
        }

        function redigeraBÃ¶cker(index) { // funktion fÃ¶r att redigera boken
            editingBookIndex = index; // SÃ¤tt indexet fÃ¶r redigering av bok
            var book = books[index]; // fÃ¥ upp bok detaljer
            document.getElementById('title').value = book.title; // SÃ¤tt in bokens titel i inmatningsfÃ¤ltet fÃ¶r titel
            document.getElementById('author').value = book.author; // SÃ¤tt in bokens fÃ¶rfattare i inmatningsfÃ¤ltet fÃ¶r author
            document.getElementById('pubDate').value = book.pubDate; // SÃ¤tt in bokutgivningsdatumet i inmatningsfÃ¤ltet fÃ¶r utgivningsdatum
            toggleBookForm(); // Visa bok formen
        }

        function taBortBÃ¶cker(index) { // funktion fÃ¶r att radera boken
            books.splice(index, 1); // rensa boken frÃ¥n array listen
            localStorage.setItem('books', JSON.stringify(books)); // Spara den uppdaterade bokarrayen i localStorage
            renderBooks(); // Rendera den uppdaterade listan Ã¶ver bÃ¶cker
        }

        
    </script>
</body>
</html>
